== setup kubernetese

=== install

https://kubernetes.io/docs/getting-started-guides/kubeadm/

=== start master

--------------------------
master# kubeadm init --pod-network-cidr 10.244.0.0/16 --skip-preflight-checks
--------------------------


=== label master node

--------------------------
$ kubectl label nodes <master-node> role=master
--------------------------

=== remove "delegated" taint from master node

--------------------------
$ kubectl taint nodes <master-node> dedicated-
--------------------------


=== start flannel

--------------------------
$ kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
--------------------------

=== fix iptables

--------------------------
node1# iptables -P FORWARD ACCEPT
--------------------------

--------------------------
node2# iptables -P FORWARD ACCEPT
--------------------------

=== join

--------------------------
node1# kubeadm join --token=<token> <master-ip> --skip-preflight-checks
--------------------------



=== start deployment

--------------------------
$ kubectl apply -f <deployment-file>
--------------------------

=== scale deployment

--------------------------
$ kubectl scale deployment <deployment-name> --replicas <num-replicas>
--------------------------

=== expose pod's ports

--------------------------
$ kubectl expose pods <pod-name> --external-ip <external-ip-address>
--------------------------

=== delete deployment

--------------------------
$ kubectl delete deployment <deployment-name>
--------------------------

=== reset cluster

--------------------------
master# kubeadm resest
--------------------------



=== example to route two vm instances

host1: running vm1
host2: running vm2

--------------------------
host1# route add -host vm2 gw host2
host2# route add -host vm1 gw host1
vm1#   route add -host vm2 gw host1
vm2#   route add -host vm1 gw host2
--------------------------
